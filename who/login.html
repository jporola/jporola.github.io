<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="main.css" />
    </head>
    <body>
        <form name="login" onsubmit="return false;">
            <input type="email" name="email" placeholder="email" required autofocus />
            <input type="password" name="password" placeholder="password" required />
            <button type="submit" name="submit" disabled="disabled">&rArr;</button>
        </form>

        <script type="module">
            import * as api from './api.js';
            import * as dom from './domUtils.js';
            import LoadingIndicator from './LoadingIndicator.js';
            import Error from './Error.js';

            const login = async (event) => {
                event.preventDefault()

                Error.hide();

                try {
                    await api.login(event.srcElement.email.value, event.srcElement.password.value);
                    LoadingIndicator.show();
                    dom.loadDefaultPage();
                } catch(error) {
                    console.error(error);
                    Error.show(error.message);
                }
            }
            document.forms.login.addEventListener('submit', login);
            document.forms.login.elements.submit.disabled = false;

            LoadingIndicator.hide();
        </script>
    </body>
</html>
